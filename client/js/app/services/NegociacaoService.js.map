{"version":3,"sources":["../../app-es6/services/NegociacaoService.js"],"names":["NegociacaoService","constructor","_http","HttpService","obterNegociacoesDaSemana","get","then","negociacoes","map","i","Negociacao","Date","data","quantidade","valor","catch","erro","console","log","Error","obterNegociacoesDaSemanaAnterior","obterNegociacoesDaSemanaTrasada","obterNegociacoes","Promise","all","results","reduce","flat","result","concat","cadastra","negociacao","ConnectionFactory","getConnection","connection","NegociacaoDao","negociacaoDao","adiciona","lista","listaTodos","apaga","apagaTodos","importa","listaAtual","filter","some","n","isEquals"],"mappings":"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","file":"NegociacaoService.js","sourcesContent":["class NegociacaoService {\n\n    constructor() {\n        this._http = new HttpService();\n    }\n\n    obterNegociacoesDaSemana() {\n        return this._http.get('negociacoes/semana')\n            .then(negociacoes => negociacoes.map(i => new Negociacao(new Date(i.data), i.quantidade, i.valor)))\n            .catch(erro => {\n                console.log(erro);\n                throw new Error('Erro ao importar negociações da semana');\n            });\n    }\n\n    obterNegociacoesDaSemanaAnterior() {\n        return this._http.get('negociacoes/anterior')\n            .then(negociacoes => negociacoes.map(i => new Negociacao(new Date(i.data), i.quantidade, i.valor)))\n            .catch(erro => {\n                console.log(erro);\n                throw new Error('Erro ao importar negociações da semana anterior');\n            });\n    }\n\n    obterNegociacoesDaSemanaTrasada() {\n        return this._http.get('negociacoes/retrasada')\n            .then(negociacoes => negociacoes.map(i => new Negociacao(new Date(i.data), i.quantidade, i.valor)))\n            .catch(erro => {\n                console.log(erro);\n                throw new Error('Erro ao importar negociações da semana retrasada');\n            });\n    }\n\n    obterNegociacoes() {\n        return Promise.all([\n            this.obterNegociacoesDaSemana(),\n            this.obterNegociacoesDaSemanaAnterior(),\n            this.obterNegociacoesDaSemanaTrasada(),\n        ]).then(results => results.reduce((flat, result) => flat.concat(result), []))\n        .catch(erro => {throw erro;});\n    }\n\n    cadastra(negociacao) {\n        return ConnectionFactory.getConnection()\n            .then(connection => new NegociacaoDao(connection))\n            .then(negociacaoDao => negociacaoDao.adiciona(negociacao))\n            .then(() => \"Negociação adicionada com sucesso!\")\n            .catch(erro => {\n                throw new Error(erro)\n            });\n    }\n\n    lista() {\n        return ConnectionFactory.getConnection()\n            .then(connection => new NegociacaoDao(connection))\n            .then(negociacaoDao => negociacaoDao.listaTodos())\n            .catch(erro => {\n                throw new Error(erro)\n            });\n    }\n\n    apaga() {\n        return ConnectionFactory.getConnection()\n            .then(connection => new NegociacaoDao(connection))\n            .then(negociacaoDao => negociacaoDao.apagaTodos())\n            .then(() => \"Negociações apagadas com sucesso!\")\n            .catch(erro => {\n                throw new Error(erro)\n            });\n    }\n\n    importa(listaAtual) {\n        return this.obterNegociacoes()\n            .then(negociacoes => negociacoes\n                .filter(negociacao => !listaAtual.some(n => n.isEquals(negociacao))))\n            .catch(erro => {\n                throw new Error(erro)\n            });\n    }\n}\n"]}